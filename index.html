<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚ù£Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            overflow: hidden;
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: none;
        }
        .font-pacifico {
            font-family: 'Pacifico', cursive;
        }
        .canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }
        .heart {
            position: absolute;
            color: #ff4d6d;
            animation: float 3s linear forwards;
            opacity: 0;
            z-index: 60;
            pointer-events: none;
        }
        @keyframes float {
            0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100vh) scale(1.5) rotate(360deg); opacity: 0; }
        }
        .btn-transition {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), left 0.3s ease, top 0.3s ease;
        }
        #no-btn {
            position: absolute;
            z-index: 100;
            white-space: nowrap;
            touch-action: none;
            left: 50%;
            transform: translateX(-50%);
        }
        #yes-btn {
            position: relative;
            z-index: 30;
            max-width: 95vw;
        }
        #main-image {
            width: 80vw;
            max-width: 300px;
            height: auto;
            object-fit: contain;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
        }
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.15'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6 2.686-6 6 0 2.21 1.79 4 4 4 3.314 0 6-2.686 6-6zm25.5 10c0-2.21-1.79-4-4-4-3.314 0-6 2.686-6 6 0 2.21 1.79 4 4 4 3.314 0 6-2.686 6-6z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            z-index: 0;
            pointer-events: none;
        }
        #content-wrapper {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
        }
    </style>
</head>
<body class="p-4">

    <div class="bg-pattern"></div>
    <canvas id="fireworks" class="canvas-container"></canvas>

    <div id="content-wrapper">
         <h1 id="question-text" class="text-3xl md:text-5xl font-pacifico text-white drop-shadow-lg mb-8 md:mb-12 text-center px-4 leading-tight">
              Will you be my valentine? ‚ù£Ô∏èüôÜ
        </h1>

        <div class="mb-4 md:mb-6">
            <img id="main-image" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHIycGZ4bm9uam9ueG9uam9ueG9uam9ueG9uam9ueG9uam9ueG9uJnB0PW0mZXA9djFfaW50ZXJuYWxfZ2lmX2J5X2lkJmN0PWc/c76IJLufpNwSULPk77/giphy.gif" 
                 alt="Valentine GIF">
        </div>

         <h3 id="description-text" class="text-3xl md:text-5xl font-pacifico text-white drop-shadow-lg mb-8 md:mb-12 text-center px-4 leading-tight">
        </h3>

        <div id="button-area" class="w-full h-40 md:h-48 relative flex items-start justify-center">
            <button id="yes-btn" class="btn-transition bg-gradient-to-r from-pink-500 to-rose-500 hover:shadow-pink-300/50 hover:shadow-2xl text-white font-bold py-3 md:py-4 px-8 md:px-12 rounded-full shadow-lg text-xl md:text-2xl">
                Yes
            </button>
            <button id="no-btn" class="btn-transition bg-white text-rose-500 border-2 border-white font-bold py-2 px-6 md:px-8 rounded-full shadow-xl text-md md:text-lg mt-20 md:mt-24">
                No
            </button>
        </div>
    </div>

    <script>
        const noTexts = ["No", "Please BuBu ü•∫", "·Äü·Ä≠·ÄØ·Ä∏ stop ·Äô·Äú·ÄØ·Äï·Ä∫·Äï·Ä´·Äî·Ä≤·Ä∑ ü•∫", "Please Mwach chi lay ü•∫", "Please don't click kalaylay", "Catch me! üòç"];
        const images = [
            "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHIycGZ4bm9uam9ueG9uam9ueG9uam9ueG9uam9ueG9uam9ueG9uJnB0PW0mZXA9djFfaW50ZXJuYWxfZ2lmX2J5X2lkJmN0PWc/c76IJLufpNwSULPk77/giphy.gif",
            'images/image_1.jpg',
            'images/image_2.jpg',
            'images/image_3.gif',
            'images/image_4.gif',
            'images/image_5.gif',
            'images/image_6.jpg',
        ];
        
        const finalImage = 'images/final.gif';

        let noClickCount = 0;
        let yesScale = 1;
        let noScale = 1;
        let isLoopCompleted = false;
        let lastActionTime = 0;

        const yesBtn = document.getElementById('yes-btn');
        const noBtn = document.getElementById('no-btn');
        const mainImg = document.getElementById('main-image');
        const questionText = document.getElementById('question-text');
        const descriptionText = document.getElementById('description-text');

        function moveNoButton() {
            const vw = window.innerWidth;
            const vh = window.innerHeight;
            
            const padding = 80;
            const btnWidth = noBtn.offsetWidth;
            const btnHeight = noBtn.offsetHeight;

            const maxX = vw - btnWidth - padding;
            const maxY = vh - btnHeight - padding;

            const randomX = Math.max(padding, Math.random() * maxX);
            const randomY = Math.max(padding, Math.random() * maxY);

            noBtn.style.position = 'fixed';
            noBtn.style.left = `${randomX}px`;
            noBtn.style.top = `${randomY}px`;
            noBtn.style.margin = '0';
            noBtn.style.transform = `scale(${noScale})`;
        }

        const handleInteractionProximity = (clientX, clientY) => {
            if (!isLoopCompleted) return;
            
            const btnRect = noBtn.getBoundingClientRect();
            const btnCenterX = btnRect.left + btnRect.width / 2;
            const btnCenterY = btnRect.top + btnRect.height / 2;

            const distance = Math.sqrt(
                Math.pow(clientX - btnCenterX, 2) + Math.pow(clientY - btnCenterY, 2)
            );

            // On mobile, distance threshold needs to be high because of finger size
            if (distance < 150) {
                moveNoButton();
            }
        };

        window.addEventListener('mousemove', (e) => handleInteractionProximity(e.clientX, e.clientY));
        window.addEventListener('touchmove', (e) => {
            if (e.touches.length > 0) {
                handleInteractionProximity(e.touches[0].clientX, e.touches[0].clientY);
            }
        }, { passive: true });

        window.addEventListener('touchstart', (e) => {
            if (isLoopCompleted && e.touches.length > 0) {
                handleInteractionProximity(e.touches[0].clientX, e.touches[0].clientY);
            }
        }, { passive: true });

        const onNoAction = (e) => {
            if (e) {
                if (isLoopCompleted) {
                    e.preventDefault();
                    e.stopPropagation();
                    moveNoButton();
                    return;
                }
            }
            
            if (Date.now() - lastActionTime < 250) return;
            lastActionTime = Date.now();

            noClickCount++;
            
            if (noClickCount >= noTexts.length - 1) {
                isLoopCompleted = true;
            }

            noBtn.innerText = noTexts[noClickCount % noTexts.length];
            mainImg.src = images[noClickCount % images.length];

            // Substantial Yes scaling
            yesScale += 0.7; 
            noScale -= 0.1;
            if (noScale < 0.4) noScale = 0.4;

            yesBtn.style.transform = `scale(${yesScale})`;
            
            moveNoButton();
            spawnHeart();
        };

        noBtn.addEventListener('click', onNoAction);
        noBtn.addEventListener('touchstart', onNoAction, { passive: false });

        // Fireworks logic
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.velocity = {
                    x: (Math.random() - 0.5) * (window.innerWidth < 768 ? 8 : 12),
                    y: (Math.random() - 0.5) * (window.innerWidth < 768 ? 8 : 12)
                };
                this.alpha = 1;
                this.friction = 0.96;
                this.gravity = 0.15;
            }
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2, 0, Math.PI * 2, false);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
            update() {
                this.velocity.x *= this.friction;
                this.velocity.y *= this.friction;
                this.velocity.y += this.gravity;
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= 0.012;
            }
        }

        function animateFireworks() {
            requestAnimationFrame(animateFireworks);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, i) => {
                if (p.alpha > 0) {
                    p.update();
                    p.draw();
                } else {
                    particles.splice(i, 1);
                }
            });
        }

        function createFirework(x, y) {
            const colors = ['#ffffff', '#ff0054', '#ffbd00', '#f900bf', '#00f5d4', '#fee440'];
            for (let i = 0; i < (window.innerWidth < 768 ? 30 : 50); i++) {
                particles.push(new Particle(x, y, colors[Math.floor(Math.random() * colors.length)]));
            }
        }

        yesBtn.addEventListener('click', () => {
            questionText.innerText = "‚ù£Ô∏èüéâ Happy 4 years & 1 month anniversary my love üéâ‚ù£Ô∏è";
            descriptionText.innerText = "4 years and 1 month together ‚Äî and my love for you only keeps growing. Thank you for being my safe place, my biggest smile, for making me stronger, and for being my sweetest blessing.  I love you more than words can say. Happy anniversary, my love bubu."
            mainImg.src = finalImage;
            noBtn.style.display = 'none';
            yesBtn.style.display = 'none';
            animateFireworks();
            setInterval(() => createFirework(Math.random() * canvas.width, Math.random() * canvas.height * 0.6), 700);
            setInterval(spawnHeart, 300);
        });

        function spawnHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = 'üíó';
            heart.className = 'heart';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.top = '100vh';
            heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 3000);
        }
    </script>
</body>
</html>